






<!doctype html>

<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" href="/_static/spectre.css">
<link rel="stylesheet" href="/_static/pygments.css">
<link rel="stylesheet" href="/_static/style.css">

<link rel="alternate" type="application/atom+xml" title="Atom feed" href="/_feed/index.xml" />







<title>The unreasonable effectiveness of f-strings and re.VERBOSE - death and gravity</title>




<script>
/* https://css-tricks.com/the-trick-to-viewport-units-on-mobile/ */
function set_vh() {
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
}
/* we do it once, now, *and* on every resize */
set_vh();
window.addEventListener('resize', set_vh);
</script>





<div class="main container grid-lg">


<header>
<nav>
<ul class="breadcrumb">

<li class="breadcrumb-item">
    <a href="/">death and gravity</a>
</li>

</ul>
</nav>

<h1 class="heading-noindex">The unreasonable effectiveness of f-strings and re.VERBOSE</h1>

<p class="text-gray"><small>
<span class="tooltip" data-tooltip="published on 2021-11-24">November 2021</span>



∙ seven minute read


</small></p>






</header>


<main class="content columns">
<div class="column col-sm-12 col-md-10 col-8">

<!-- candidate slug: f-regex, f-pattern, f-re, ... -->
<p>... in which we look at one or two ways of making life way easier
when working with Python regular expressions.</p>
<p>tl;dr: <strong>You can compose verbose regular expressions using f-strings.</strong></p>
<p>Here's a real-world example – instead of this:</p>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">1</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;((?:\(\s*)?[A-Z]*H\d+[a-z]*(?:\s*\+\s*[A-Z]*H\d+[a-z]*)*(?:\s*[\):+])?)(.*?)(?=(?:\(\s*)?[A-Z]*H\d+[a-z]*(?:\s*\+\s*[A-Z]*H\d+[a-z]*)*(?:\s*[\):+])?(?![^\w\s])|$)&quot;</span>
</code></pre></div>
</td></tr></table>
<p>... do this:</p>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">code</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">[A-Z]*H  # prefix</span>
<span class="s2">\d+      # digits</span>
<span class="s2">[a-z]*   # suffix</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">multicode</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">(?: \( \s* )?               # maybe open paren and maybe space</span>
<span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">                      # one code</span>
<span class="s2">(?: \s* \+ \s* </span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2"> )*    # maybe followed by other codes, plus-separated</span>
<span class="s2">(?: \s* [\):+] )?           # maybe space and maybe close paren or colon or plus</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">pattern</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">( </span><span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2"> )             # code (capture)</span>
<span class="s2">( .*? )                     # message (capture): everything ...</span>
<span class="s2">(?=                         # ... up to (but excluding) ...</span>
<span class="s2">    </span><span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2">             # ... the next code</span>
<span class="s2">        (?! [^\w\s] )       # (but not when followed by punctuation)</span>
<span class="s2">    | $                     # ... or the end</span>
<span class="s2">)</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
<details>
<summary>
For comparison, the same pattern without f-strings (click to expand).
</summary>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">(                       # code (capture)</span>
<span class="s2">    # BEGIN multicode</span>

<span class="s2">    (?: \( \s* )?       # maybe open paren and maybe space</span>

<span class="s2">    # code</span>
<span class="s2">    [A-Z]*H  # prefix</span>
<span class="s2">    \d+      # digits</span>
<span class="s2">    [a-z]*   # suffix</span>

<span class="s2">    (?:                 # maybe followed by other codes,</span>
<span class="s2">        \s* \+ \s*      # ... plus-separated</span>

<span class="s2">        # code</span>
<span class="s2">        [A-Z]*H  # prefix</span>
<span class="s2">        \d+      # digits</span>
<span class="s2">        [a-z]*   # suffix</span>
<span class="s2">    )*</span>

<span class="s2">    (?: \s* [\):+] )?   # maybe space and maybe close paren or colon or plus</span>

<span class="s2">    # END multicode</span>
<span class="s2">)</span>

<span class="s2">( .*? )                 # message (capture): everything ...</span>

<span class="s2">(?=                     # ... up to (but excluding) ...</span>
<span class="s2">    # ... the next code</span>

<span class="s2">    # BEGIN multicode</span>

<span class="s2">    (?: \( \s* )?       # maybe open paren and maybe space</span>

<span class="s2">    # code</span>
<span class="s2">    [A-Z]*H  # prefix</span>
<span class="s2">    \d+      # digits</span>
<span class="s2">    [a-z]*   # suffix</span>

<span class="s2">    (?:                 # maybe followed by other codes,</span>
<span class="s2">        \s* \+ \s*      # ... plus-separated</span>

<span class="s2">        # code</span>
<span class="s2">        [A-Z]*H  # prefix</span>
<span class="s2">        \d+      # digits</span>
<span class="s2">        [a-z]*   # suffix</span>
<span class="s2">    )*</span>

<span class="s2">    (?: \s* [\):+] )?   # maybe space and maybe close paren or colon or plus</span>

<span class="s2">    # END multicode</span>

<span class="s2">        # (but not when followed by punctuation)</span>
<span class="s2">        (?! [^\w\s] )</span>

<span class="s2">    # ... or the end</span>
<span class="s2">    | $</span>
<span class="s2">)</span>

<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
</details>
<p>Read on for <strong>more details</strong>, some <strong>caveats</strong> and a <strong>worked example</strong>.</p>
<h2 id="prerequisites">Prerequisites<span class="headerlink"> <a href="#prerequisites" title="permalink">#</a></span></h2>
<p><a href="https://docs.python.org/3/glossary.html#term-f-string">f-strings</a> (formatted string literals) were added in Python 3.6,
and provide a way to embed expressions inside string literals,
using a syntax similar to that of <a href="https://docs.python.org/3/library/stdtypes.html#str.format">str.format</a>:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;world&quot;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;Hello, </span><span class="si">{name}</span><span class="s2">!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
<span class="go">&#39;Hello, world!&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
<span class="go">&#39;Hello, world!&#39;</span>
</code></pre></div>
<p><a href="https://docs.python.org/3/library/re.html#re.VERBOSE">re.VERBOSE</a> (verbose regular expressions) have been in Python since forever<sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup>,
and allow writing nice, readable regular expressions
by allowing you to ignore whitespace and add comments:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;H1 code (AH2b+EUH3) fancy code&quot;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[A-Z]*H\d+[a-z]*&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="go">[&#39;H1&#39;, &#39;AH2b&#39;, &#39;EUH3&#39;]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">[A-Z]*H  # prefix</span>
<span class="gp">... </span><span class="s2">\d+      # digits</span>
<span class="gp">... </span><span class="s2">[a-z]*   # suffix</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="go">[&#39;H1&#39;, &#39;AH2b&#39;, &#39;EUH3&#39;]</span>
</code></pre></div>
<h2 id="the-one-weird-trick">The &quot;one weird trick&quot;<span class="headerlink"> <a href="#the-one-weird-trick" title="permalink">#</a></span></h2>
<p>Once you see it, it's obvious
– you can use f-strings to compose regular expressions:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">multicode</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">(?: \( )?         # maybe open paren</span>
<span class="gp">... </span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">            # one code</span>
<span class="gp">... </span><span class="s2">(?: \+ </span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2"> )*  # maybe other codes, plus-separated</span>
<span class="gp">... </span><span class="s2">(?: \) )?         # maybe close paren</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">multicode</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="go">[&#39;H1&#39;, &#39;(AH2b+EUH3)&#39;]</span>
</code></pre></div>
<p>It's so obvious,
I only started doing it  after I started using Python 3.6 :)</p>
<p>Of course, there's any number of libraries
for building composable regular expressions;
the benefit of this is that it has zero dependencies,
and zero extra things you need to learn.</p>
<form
    action="https://gmail.us7.list-manage.com/subscribe/post?u=9909b0e978d8d8d941bd3c8dc&amp;id=c61d63d661&SIGNUP=regex"
    method="post"
    id="embedded-subscribe-form"
    name="mc-embedded-subscribe-form"
    target="_blank"
    novalidate
    class="panel subscribe-form"
>
    <div class="panel-header text-large">

        Want to know when new articles come out?

    </div>
    <div class="panel-body">

        <p>Drop your email in the box below and I'll send new stuff straight to your inbox!</p>

        <div class="form-group col-6 col-xs-12 col-md-9">
        <input type="text" name="FNAME" id="mce-FNAME"
            class="form-input input-lg"
            placeholder="Your first name"
        >
        </div>

        <div class="form-group col-6 col-xs-12 col-md-9">
        <input type="email" name="EMAIL" id="mce-EMAIL"
            class="form-input input-lg"
            placeholder="Your email address"
        >
        </div>

        <!-- bot prevention-->
        <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_9909b0e978d8d8d941bd3c8dc_c61d63d661" tabindex="-1" value=""></div>

    </div>
    <div class="panel-footer">

        <div class="form-group">
        <input type="submit"  name="subscribe" id="mc-embedded-subscribe"
            class="btn btn-primary btn-lg"
            value="Subscribe"
        >
        </div>

    </div>

</form>
<h2 id="caveats">Caveats<span class="headerlink"> <a href="#caveats" title="permalink">#</a></span></h2>
<h3 id="hashes-need-extra-care">Hashes need extra care<span class="headerlink"> <a href="#hashes-need-extra-care" title="permalink">#</a></span></h3>
<p>Because <code>#</code> is already used to mark the start of a comment,
you have to denote hash characters in some other way.</p>
<p>The documentation of <a href="https://docs.python.org/3/library/re.html#re.VERBOSE">re.VERBOSE</a> is quite helpful:</p>
<blockquote>
<p>When a line contains a <code>#</code> that is not in a character class and is not preceded by an unescaped backslash, all characters from the leftmost such <code>#</code> through the end of the line are ignored.</p>
</blockquote>
<p>That is, this won't work as the non-verbose version:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;\d+#\d+&quot;</span><span class="p">,</span> <span class="s2">&quot;1#23a&quot;</span><span class="p">)</span>
<span class="go">[&#39;1#23&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;\d+ # \d+&quot;</span><span class="p">,</span> <span class="s2">&quot;1#23a&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="go">[&#39;1&#39;, &#39;23&#39;]</span>
</code></pre></div>
<p>... but these will:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;\d+ [#] \d+&quot;</span><span class="p">,</span> <span class="s2">&quot;1#23a&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="go">[&#39;1#23&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;\d+ \# \d+&quot;</span><span class="p">,</span> <span class="s2">&quot;1#23a&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="go">[&#39;1#23&#39;]</span>
</code></pre></div>
<p>Also, ending a pattern after a comment might accidentally comment the line after it in the bigger pattern:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">one</span> <span class="o">=</span> <span class="s2">&quot;1 # comment&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">onetwo</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">one</span><span class="si">}</span><span class="s2"> 2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">onetwo</span><span class="p">,</span> <span class="s1">&#39;0123&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="go">[&#39;1&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">onetwo</span><span class="p">)</span>
<span class="go">1 # comment 2</span>
</code></pre></div>
<p>This can be avoided by always ending the pattern on a new line:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">one</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="gp">... </span><span class="s2">1 # comment</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">onetwo</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="gp">... </span><span class="si">{</span><span class="n">one</span><span class="si">}</span><span class="s2"> 2</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">onetwo</span><span class="p">,</span> <span class="s1">&#39;0123&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="go">[&#39;12&#39;]</span>
</code></pre></div>
<p>(Note that this is only needed if you use comments.)</p>
<p>While a bit cumbersome here,
in real life most patterns would span multiple lines anyway,
so that's not really an issue.</p>
<h3 id="brace-repetitions-need-to-be-escaped">Brace repetitions need to be escaped<span class="headerlink"> <a href="#brace-repetitions-need-to-be-escaped" title="permalink">#</a></span></h3>
<p>Because f-strings already use braces for replacements,
to denote brace repetitions you must double the braces:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;m</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;entire mm but only two of mmm&quot;</span><span class="p">)</span>
<span class="go">[&#39;mm&#39;, &#39;mm&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">letter</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pattern</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">letter</span><span class="si">}</span><span class="se">{{</span><span class="s2">2</span><span class="se">}}</span><span class="s2">&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s2">&quot;entire mm but only two of mmm&quot;</span><span class="p">)</span>
<span class="go">[&#39;mm&#39;, &#39;mm&#39;]</span>
</code></pre></div>
<h3 id="i-don-t-control-the-flags">I don't control the flags<span class="headerlink"> <a href="#i-don-t-control-the-flags" title="permalink">#</a></span></h3>
<p>Maybe you'd like to use verbose regexes, but don't control the flags passed to <a href="https://docs.python.org/3/library/re.html">re</a>.</p>
<p>Worry not! The regular expression <a href="https://docs.python.org/3/library/re.html#regular-expression-syntax">syntax</a> supports inline flags:</p>
<blockquote>
<dl>
<dt><code>(?aiLmsux)</code></dt>
<dd>(One or more letters [...]) The group matches the empty string; the letters set the corresponding flags: [...] <a href="https://docs.python.org/3/library/re.html#re.VERBOSE">re.X</a> (verbose), for the entire regular expression. [...] This is useful if you wish to include the flags as part of the regular expression, instead of passing a flag argument to the <a href="https://docs.python.org/3/library/re.html#re.compile">re.compile()</a> function. Flags should be used first in the expression string.</dd>
<dt><code>(?aiLmsux-imsx:...)</code></dt>
<dd>[...] The letters set or remove the corresponding flags [...] for the part of the expression. [...]</dd>
</dl>
</blockquote>
<p>So:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">onetwo</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="gp">... </span><span class="s2">(?x)</span>
<span class="gp">... </span><span class="s2">1 # look, ma</span>
<span class="gp">... </span><span class="s2">2 # no flags</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">onetwo</span><span class="p">,</span> <span class="s1">&#39;0123&#39;</span><span class="p">)</span>
<span class="go">[&#39;12&#39;]</span>
</code></pre></div>
<p>... and:</p>
<div class="highlight code-container"><pre class="code" data-lang="Python console session"><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">onetwo</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="gp">... </span><span class="s2">(?x:</span>
<span class="gp">... </span><span class="s2">    1 # verbose until the close paren</span>
<span class="gp">... </span><span class="s2">)2&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">onetwo</span><span class="p">,</span> <span class="s1">&#39;0123&#39;</span><span class="p">)</span>
<span class="go">[&#39;12&#39;]</span>
</code></pre></div>
<h3 id="i-don-t-use-python">I don't use Python<span class="headerlink"> <a href="#i-don-t-use-python" title="permalink">#</a></span></h3>
<p>Lots of other languages support inline flags:</p>
<div class="highlight code-container"><pre class="code" data-lang="Rust"><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">regex</span>::<span class="n">Regex</span>::<span class="n">new</span><span class="p">(</span><span class="s">r&quot;(?x)</span>
<span class="s">    1 2 # such inline</span>
<span class="s">&quot;</span><span class="p">).</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="fm">println!</span><span class="p">(</span><span class="s">&quot;{}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;0123&quot;</span><span class="p">).</span><span class="n">unwrap</span><span class="p">().</span><span class="n">as_str</span><span class="p">());</span><span class="w"></span>
</code></pre></div>
<div class="highlight code-container"><pre class="code" data-lang="PostgreSQL SQL dialect"><span></span><code><span class="k">select</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="s1">&#39;0123&#39;</span><span class="w"> </span><span class="k">from</span><span class="w"></span>
<span class="w">    </span><span class="s">$$(?x)</span>
<span class="s">    1 2 # much verbose</span>
<span class="s">    $$</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</code></pre></div>
<div class="highlight code-container"><pre class="code" data-lang="Java"><span></span><code><span class="kd">var</span> <span class="n">p</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">regex</span><span class="p">.</span><span class="na">Pattern</span><span class="p">.</span><span class="na">compile</span><span class="p">(</span>
    <span class="s">&quot;(?x)\n&quot;</span> <span class="o">+</span>
    <span class="s">&quot;1 2 # nice\n&quot;</span>
<span class="p">);</span>
<span class="kd">var</span> <span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="na">matcher</span><span class="p">(</span><span class="s">&quot;0123&quot;</span><span class="p">);</span>
<span class="n">m</span><span class="p">.</span><span class="na">find</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="na">group</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
</code></pre></div>
<div class="highlight code-container"><pre class="code" data-lang="Perl"><span></span><code><span class="s">&quot;0123&quot;</span> <span class="o">=~</span><span class="sr"> /(?x)</span>
<span class="sr">(</span>
<span class="sr">    1 2 # no scare</span>
<span class="sr">)</span>
<span class="sr">/</span><span class="p">;</span>
<span class="k">print</span> <span class="nv">$1</span> <span class="o">.</span> <span class="s">&quot;\n&quot;</span><span class="p">;</span>
</code></pre></div>
<div class="highlight code-container"><pre class="code" data-lang="PHP"><span></span><code><span class="cp">&lt;?php</span>
<span class="nv">$str</span> <span class="o">=</span> <span class="s2">&quot;0123&quot;</span><span class="p">;</span>
<span class="nv">$pattern</span> <span class="o">=</span> <span class="s2">&quot;/(?x)</span>
<span class="s2">    1 2 # concern</span>
<span class="s2">/&quot;</span><span class="p">;</span>
<span class="nb">preg_match</span><span class="p">(</span><span class="nv">$pattern</span><span class="p">,</span> <span class="nv">$str</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</code></pre></div>
<p>But not Javascript, Go (regexp), ...</p>
<h2 id="worked-example">worked example<span class="headerlink"> <a href="#worked-example" title="permalink">#</a></span></h2>
<ul>
<li>https://en.wikipedia.org/wiki/GHS_hazard_statements</li>
<li>get them from some kind of OCR thing (textract, or smth else)</li>
<li>format, from the wiki page<ul>
<li>H200: Unstable explosive</li>
<li>H313+H333: May be harmful in contact with skin or if inhaled</li>
<li>H361f: Suspected of damaging fertility</li>
<li>EUH014: Reacts violently with water</li>
<li>AUH014: Reacts violently with water</li>
</ul>
</li>
<li>variations (text doesnt follow the format 100%, ocr isn't perfect)<ul>
<li>not on a single line</li>
<li>no colon &quot;H123 message&quot;</li>
<li>parens &quot;(H123) message&quot;, sometimes mismatched &quot;(H123 message&quot;</li>
<li>weird spacing &quot;  H1+ H2    +H4 whatever&quot;</li>
<li>&quot;H6 word; see also H2; H7 another&quot;</li>
</ul>
</li>
</ul>
<h3 id="code">code<span class="headerlink"> <a href="#code" title="permalink">#</a></span></h3>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">H123 word EUH4 multi</span>
<span class="s2">line H5ab with suffix</span>
<span class="s2">H5c per directive A240</span>
<span class="s2">H6 word; see also H2;</span>
<span class="s2">H7+EUH8c multiple codes. and two sentences.</span>
<span class="s2">  H7+ EUH8c+H9 multiple codes with weird spacing</span>

<span class="s2">(H6) in parens, after blank line</span>
<span class="s2">( H7 + EUH8c ) multiple codes in parens</span>
<span class="s2">H10) unmatched paren</span>
<span class="s2">H11: colon</span>
<span class="s2">H12+stray plus</span>
<span class="s2">H13 until the end</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">code</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">[A-Z]*H  # prefix</span>
<span class="s2">\d+      # digits</span>
<span class="s2">[a-z]*   # suffix</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">pattern</span> <span class="o">=</span> <span class="n">code</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">repr</span><span class="p">,</span> <span class="n">result</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>finditer and not findall because we will eventually capture stuff, and we'll need access to groups</p>
<div class="highlight code-container"><pre class="code" data-lang="Text only"><span></span><code>&#39;H123&#39;
&#39;EUH4&#39;
...
&#39;H7&#39;
&#39;EUH8c&#39;
...
</code></pre></div>
<h3 id="multi-code">multi-code<span class="headerlink"> <a href="#multi-code" title="permalink">#</a></span></h3>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">multicode</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">(?: \( \s* )?               # maybe open paren and maybe space</span>
<span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">                      # one code</span>
<span class="s2">(?: \s* \+ \s* </span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2"> )*    # maybe followed by other codes, plus-separated</span>
<span class="s2">(?: \s* [\):+] )?           # maybe space and maybe close paren or colon or plus</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">pattern</span> <span class="o">=</span> <span class="n">multicode</span>
</code></pre></div>
</td></tr></table>
<p>non-capturing from the start, we know we don't need any of these</p>
<div class="highlight code-container"><pre class="code" data-lang="Text only"><span></span><code>&#39;H123&#39;
...
&#39;H7+EUH8c&#39;
&#39;H7+ EUH8c+H9&#39;
&#39;(H6)&#39;
&#39;( H7 + EUH8c )&#39;
&#39;H10)&#39;
&#39;H11:&#39;
&#39;H12+&#39;
&#39;H13&#39;
</code></pre></div>
<h3 id="pattern">pattern<span class="headerlink"> <a href="#pattern" title="permalink">#</a></span></h3>
<p>https://docs.python.org/3/library/re.html#regular-expression-syntax</p>
<blockquote>
<p>(?=...) Matches if ... matches next, but doesn’t consume any of the string. This is called a <em>lookahead assertion</em>.</p>
</blockquote>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">pattern</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;&quot;&quot;</span>
<span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2">                 # code</span>
<span class="s2">.*                          # message: everything ...</span>
<span class="s2">(?= </span><span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2"> )           # ... up to (but excluding) the next code</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight code-container"><pre class="code" data-lang="Text only"><span></span><code>&#39;H123 word EUH4 multi\nline H5ab ...
</code></pre></div>
<p>uh-oh</p>
<blockquote>
<p><em>?, +?, ?? The '</em>', '+', and '?' qualifiers are all greedy; they match as much text as possible. [...] Adding ? after the qualifier makes it perform the match in non-greedy or minimal fashion; as few characters as possible will be matched.</p>
</blockquote>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">pattern</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;&quot;&quot;</span>
<span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2">                 # code</span>
<span class="hll"><span class="s2">.*?                         # message: everything ...</span>
</span><span class="s2">(?= </span><span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2"> )           # ... up to (but excluding) the next code</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight code-container"><pre class="code" data-lang="Text only"><span></span><code>&#39;H123 word &#39;
&#39;EUH4 multi\nline &#39;
...
&#39;H12+stray plus\n&#39;
</code></pre></div>
<p>seems like we're missing the last thing</p>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">pattern</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;&quot;&quot;</span>
<span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2">                 # code</span>
<span class="s2">.*?                         # message: everything ...</span>
<span class="s2">(?=                         # ... up to (but excluding) ...</span>
<span class="s2">    </span><span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2">             # ... the next code</span>
<span class="hll"><span class="s2">    | $                     # ... or the end</span>
</span><span class="s2">)</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
<div class="highlight code-container"><pre class="code" data-lang="Text only"><span></span><code>...
&#39;H13 until the end&#39;
</code></pre></div>
<h3 id="mid-sentence-codes">mid-sentence codes<span class="headerlink"> <a href="#mid-sentence-codes" title="permalink">#</a></span></h3>
<div class="highlight code-container"><pre class="code" data-lang="Text only"><span></span><code>...
&#39;H6 word; see also &#39;
&#39;H2;\n&#39;
...
</code></pre></div>
<blockquote>
<p>(?!...) Matches if ... doesn’t match next. This is a negative lookahead assertion.</p>
</blockquote>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">pattern</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;&quot;&quot;</span>
<span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2">                 # code</span>
<span class="s2">.*?                         # message: everything ...</span>
<span class="s2">(?=                         # ... up to (but excluding) ...</span>
<span class="s2">    </span><span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2">             # ... the next code</span>
<span class="hll"><span class="s2">        (?! [^\w\s] )       # (but not when followed by punctuation)</span>
</span><span class="s2">    | $                     # ... or the end</span>
<span class="s2">)</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
<p>&quot;not when followed by punctuation&quot; could have been
[{ re.escape(string.punctuation) }] but this is unicode-aware</p>
<p>[.,;&quot;'] doesnt work for the same reason</p>
<p>might get false positives for &quot;see also [H2]&quot;,
but we're reaching into NLP territory now;
this seems like a decent tradeoff</p>
<div class="highlight code-container"><pre class="code" data-lang="Text only"><span></span><code>...
&#39;H6 word; see also H2;\n&#39;
...
</code></pre></div>
<h3 id="groups">groups<span class="headerlink"> <a href="#groups" title="permalink">#</a></span></h3>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">pattern</span> <span class="o">=</span> <span class="sa">fr</span><span class="s2">&quot;&quot;&quot;</span>
<span class="hll"><span class="s2">( </span><span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2"> )             # code (capture)</span>
</span><span class="hll"><span class="s2">( .*? )                     # message (capture): everything ...</span>
</span><span class="s2">(?=                         # ... up to (but excluding) ...</span>
<span class="s2">    </span><span class="si">{</span><span class="n">multicode</span><span class="si">}</span><span class="s2">             # ... the next code</span>
<span class="s2">        (?! [^\w\s] )       # (but not when followed by punctuation)</span>
<span class="s2">    | $                     # ... or the end</span>
<span class="s2">)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
<span class="hll"><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">]</span>
</span><span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">repr</span><span class="p">,</span> <span class="n">result</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="highlight code-container"><pre class="code" data-lang="Text only"><span></span><code>(&#39;H123&#39;, &#39; word &#39;)
...
&#39;( H7 + EUH8c )&#39;, &#39; multiple codes in parens\n&#39;)
...
</code></pre></div>
<h3 id="splitting-codes">splitting codes<span class="headerlink"> <a href="#splitting-codes" title="permalink">#</a></span></h3>
<table class="highlighttable code-container"><tr><td class="linenos"><div class="linenodiv"><pre class="code"><code><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></code></pre></div></td><td class="code"><div class="highlight"><pre class="code" data-lang="Python"><span></span><code><span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
<span class="hll"><span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">]</span>
</span><span class="hll"><span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="hll">    <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">code_part</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">),</span> <span class="n">message_part</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span class="hll">    <span class="k">for</span> <span class="n">code_part</span><span class="p">,</span> <span class="n">message_part</span> <span class="ow">in</span> <span class="n">groups</span>
</span><span class="hll"><span class="p">]</span>
</span><span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">repr</span><span class="p">,</span> <span class="n">result</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="highlight code-container"><pre class="code" data-lang="Text only"><span></span><code>([&#39;H123&#39;], &#39;word&#39;)
...
([&#39;H7&#39;, &#39;EUH8c&#39;], &#39;multiple codes in parens&#39;)
...
</code></pre></div>
<p>... note the .strip(); can also be done with regexes, but it's overkill</p>
<p>TODO: download file</p>
<section class="footnotes">
<ol>
<li id="fn-1"><p>... that is, since at least <a href="https://docs.python.org/release/1.5.2p2/lib/Contents_of_Module_re.html#l2h-573">Python 1.5.2</a>, released in 1998 –
for all except a tiny minority of Python users, that's <em>before</em> forever. <a href="#fnref-1" class="footnote"><sup>[return]</sup></a></p></li>
</ol>
</section>








</div>
</main>


<footer class="footer">
<p class="text-gray">
<a href="/">home</a>
∙ <a href="/_feed/index.xml">feed</a>
∙ <a href="/about">about</a>

∙ © 2021 lemon24



</footer>


</div>